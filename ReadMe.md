This is in cpp branch.
